<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from www.pyret.org/docs/s_placeholders.html by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 24 Apr 2014 07:13:04 GMT -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><title>15&nbsp;Placeholders</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default" /><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="http://www.pyret.org/docs/index.html" class="tocviewlink" data-pltdoc="x">Pyret Language Reference</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="s_installing.html" class="tocviewlink" data-pltdoc="x">Installing Pyret</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="s_running.html" class="tocviewlink" data-pltdoc="x">Editing and Running Pyret</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="s_forms.html" class="tocviewlink" data-pltdoc="x">Language Constructs</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="s_testing.html" class="tocviewlink" data-pltdoc="x">Testing</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="s_lists.html" class="tocviewlink" data-pltdoc="x">Lists</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="s_arrays.html" class="tocviewlink" data-pltdoc="x">Arrays</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="s_timing.html" class="tocviewlink" data-pltdoc="x">Timing Pyret Programs</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="s_cmdline.html" class="tocviewlink" data-pltdoc="x">Handling Command-<wbr></wbr>line Arguments</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="s_option.html" class="tocviewlink" data-pltdoc="x">Option</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="s_set.html" class="tocviewlink" data-pltdoc="x">Sets</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="s_numbers.html" class="tocviewlink" data-pltdoc="x">Numbers</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="s_strings.html" class="tocviewlink" data-pltdoc="x">Strings</a></td></tr><tr><td align="right">13&nbsp;</td><td><a href="s_misc.html" class="tocviewlink" data-pltdoc="x">Miscellaneous Functions</a></td></tr><tr><td align="right">14&nbsp;</td><td><a href="s_mutables.html" class="tocviewlink" data-pltdoc="x">Mutables</a></td></tr><tr><td align="right">15&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Placeholders</a></td></tr><tr><td align="right">16&nbsp;</td><td><a href="s_ast.html" class="tocviewlink" data-pltdoc="x">AST</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><a href="#(.Placeholder..get._.Placeholder..get)" class="tocsublink" data-pltdoc="x"><span style="font-weight: bold">Placeholder.get</span></a></td></tr><tr><td><a href="#(.Placeholder..guard._.Placeholder..guard)" class="tocsublink" data-pltdoc="x"><span style="font-weight: bold">Placeholder.guard</span></a></td></tr><tr><td><a href="#(.Placeholder..set._.Placeholder..set)" class="tocsublink" data-pltdoc="x"><span style="font-weight: bold">Placeholder.set</span></a></td></tr><tr><td><a href="#(.Placeholder.._equals._.Placeholder.._equals)" class="tocsublink" data-pltdoc="x"><span style="font-weight: bold">Placeholder._<span class="mywbr"> &nbsp;</span>equals</span></a></td></tr><tr><td><a href="#(.Placeholder..tostring._.Placeholder..tostring)" class="tocsublink" data-pltdoc="x"><span style="font-weight: bold">Placeholder.tostring</span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="s_mutables.html" title="backward to &quot;14 Mutables&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="http://www.pyret.org/docs/index.html" title="up to &quot;Pyret Language Reference&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="s_ast.html" title="forward to &quot;16 AST&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>15<tt>&nbsp;</tt><a name="(part._s~3aplaceholders)"></a>Placeholders</h3><p>Placeholder values are created automatically by <span class="stt">graph</span> declarations, and
can be explicitly created with <span class="stt">mk-placeholder</span>, though most Pyret programs
will not need to.  This section is mainly for those wishing a deeper
understanding of how <span class="stt">graph</span> and <span class="stt">cyclic</span> interact.</p><p>A <span class="stt">Placeholder</span> is a value that supports a single <span style="font-style: italic">update</span>, and
multiple <span style="font-style: italic">guards</span> before being updated.  The design goal of
<span class="stt">Placeholder</span>s is to support many contexts sharing the same (possibly
un-initialized) value, with each context placing its own constraints on the
value prior to it being initialized.  The following methods are on each
<span class="stt">Placeholder</span> value:</p><p><a name="(.Placeholder..get._.Placeholder..get)"></a><span style="font-weight: bold">Placeholder.get</span></p><blockquote class="SCodeFlow"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">get(self :: Placeholder&lt;a&gt;) -&gt; a</span></span></p></td></tr></table></blockquote><p>Get the value in the placeholder.  Signals an exception if the value has
<span style="font-style: italic">yet to be</span> initialized with the <span class="stt">set</span> method.</p><p><a name="(.Placeholder..guard._.Placeholder..guard)"></a><span style="font-weight: bold">Placeholder.guard</span></p><blockquote class="SCodeFlow"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">guard(self :: Placeholder&lt;a&gt;, guard :: (a -&gt; Bool)) -&gt; Nothing</span></span></p></td></tr></table></blockquote><p>Update the placeholder with an additional check <span class="stt">guard</span>.  Signals an
exception if the value has <span style="font-style: italic">already been</span> initialized with the <span class="stt">set</span>
method.</p><p><a name="(.Placeholder..set._.Placeholder..set)"></a><span style="font-weight: bold">Placeholder.set</span></p><blockquote class="SCodeFlow"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">set(self :: Placeholder&lt;a&gt;, value :: a) -&gt; a</span></span></p></td></tr></table></blockquote><p>Initialize the placeholder with <span class="stt">value</span>.  Signals an exception if the
placeholder has already been <span class="stt">set</span>.  Before setting <span class="stt">value</span> as the value
of the placeholder, first applies all wrappers to it in the reverse order they
were added (so the first added guard is applied last).  The result of each
application is passed to the next wrapper.  Note that these wrappers can throw
exceptions, and do when compiled from annotations.</p><p>These three methods are used in concert by <span class="stt">graph</span> and <span class="stt">cyclic</span> to safely
and lazily intialize mutually-referential data.  Each left-hand side in a
<span class="stt">graph</span> binding gets a new placeholder value with no guards.  Each
constructor with a <span class="stt">cyclic</span> modifier on a field that is called adds a guard
to the placeholder based on the annotation on that field.  Then, at the end of
the <span class="stt">graph</span> declaration, the placeholders are all <span class="stt">set</span> to the values on
the right-hand side of the graph bindings.  If any placeholder was used in an
incorrect context, a type error is signalled at this point.  After graph
initialization, subsequent accesses of the placeholder fields with
<a href="s_forms.html#%28part._s~3adot-expr%29" data-pltdoc="x">dot expressions</a> use the <span class="stt">get</span> operation to access
the initialized value.</p><p>A few other methods are on <span class="stt">Placeholder</span> values, as well:</p><p><a name="(.Placeholder.._equals._.Placeholder.._equals)"></a><span style="font-weight: bold">Placeholder._equals</span></p><blockquote class="SCodeFlow"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">_equals(self :: Placeholder&lt;a&gt;, other :: Any) -&gt; Bool</span></span></p></td></tr></table></blockquote><p>Returns <span class="stt">true</span> if <span class="stt">other</span> is the <span style="font-style: italic">same</span> <span class="stt">Placeholer</span> as this one,
<span class="stt">false</span> otherwise.</p><p><a name="(.Placeholder..tostring._.Placeholder..tostring)"></a><span style="font-weight: bold">Placeholder.tostring</span></p><blockquote class="SCodeFlow"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">tostring(self :: Placeholder&lt;a&gt;) -&gt; String</span></span></p></td></tr></table></blockquote><p>Returns a string representation of the placeholder.  To avoid cyclic printing, this
just gives the string <span class="stt">"placeholder-field"</span>.</p><div class="navsetbottom"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="s_mutables.html" title="backward to &quot;14 Mutables&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="http://www.pyret.org/docs/index.html" title="up to &quot;Pyret Language Reference&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="s_ast.html" title="forward to &quot;16 AST&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from www.pyret.org/docs/s_placeholders.html by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 24 Apr 2014 07:13:04 GMT -->
</html>